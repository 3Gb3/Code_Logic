{% extends "base_aula.html" %}

{% block title %}Aula 9 - Boas Práticas | CodeLogic{% endblock %}

{% block lesson_title %}Aula 9 – Boas Práticas em Estruturas Condicionais{% endblock %}

{% block lesson_content %}
    <section>
        <h2>🎯 Objetivo</h2>
        <ul>
            <li>Aplicar boas práticas em código condicional</li>
            <li>Escrever código mais limpo e legível</li>
            <li>Evitar erros comuns e anti-padrões</li>
        </ul>
    </section>

    <section>
        <h2>✨ Princípios de Código Limpo</h2>
        
        <h3>1. Nomes Descritivos</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if x > 18:
    y = True</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>if idade > 18:
    pode_votar = True</code></pre>
            </div>
        </div>
        
        <h3>2. Evite Negações Desnecessárias</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if not not usuario_logado:
    print("Bem-vindo!")</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>if usuario_logado:
    print("Bem-vindo!")</code></pre>
            </div>
        </div>
    </section>

    <section>
        <h2>🏗️ Estruturação de Condições</h2>
        
        <h3>1. Early Return (Retorno Antecipado)</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>def processar_usuario(usuario):
    if usuario is not None:
        if usuario.ativo:
            if usuario.idade >= 18:
                # processar usuário
                return True
            else:
                return False
        else:
            return False
    else:
        return False</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>def processar_usuario(usuario):
    if usuario is None:
        return False
    
    if not usuario.ativo:
        return False
    
    if usuario.idade < 18:
        return False
    
    # processar usuário
    return True</code></pre>
            </div>
        </div>
        
        <h3>2. Extrair Condições Complexas</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if (usuario.idade >= 18 and usuario.tem_carteira and 
    usuario.pontos >= 10 and not usuario.suspenso):
    liberar_acesso()</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>def pode_acessar(usuario):
    return (usuario.idade >= 18 and 
            usuario.tem_carteira and 
            usuario.pontos >= 10 and 
            not usuario.suspenso)

if pode_acessar(usuario):
    liberar_acesso()</code></pre>
            </div>
        </div>
    </section>

    <section>
        <h2>🔍 Validação Eficiente</h2>
        
        <h3>1. Validação em Cascata</h3>
        <pre><code>def validar_email(email):
    """Valida email de forma estruturada"""
    if not email:
        return False, "Email é obrigatório"
    
    if "@" not in email:
        return False, "Email deve conter @"
    
    if "." not in email.split("@")[1]:
        return False, "Domínio inválido"
    
    return True, "Email válido"

# Uso
email = input("Digite seu email: ")
valido, mensagem = validar_email(email)

if valido:
    print(f"✅ {mensagem}")
else:
    print(f"❌ {mensagem}")</code></pre>
    
        <h3>2. Dicionário para Múltiplas Condições</h3>
        <pre><code># Em vez de muitos if-elif
def calcular_desconto(categoria):
    descontos = {
        "vip": 0.20,
        "premium": 0.15,
        "regular": 0.10,
        "bronze": 0.05
    }
    return descontos.get(categoria, 0)</code></pre>
    </section>

    <section>
        <h2>🚫 Erros Comuns a Evitar</h2>
        
        <h3>1. Comparação com True/False</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if usuario_ativo == True:
    print("Usuário ativo")</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>if usuario_ativo:
    print("Usuário ativo")</code></pre>
            </div>
        </div>
        
        <h3>2. Condições Redundantes</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if idade >= 18:
    pode_votar = True
else:
    pode_votar = False</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>pode_votar = idade >= 18</code></pre>
            </div>
        </div>
        
        <h3>3. Aninhamento Excessivo</h3>
        <div class="comparison">
            <div class="bad-example">
                <h4>❌ Ruim:</h4>
                <pre><code>if usuario:
    if usuario.ativo:
        if usuario.permissao:
            if recurso_disponivel:
                processar()</code></pre>
            </div>
            <div class="good-example">
                <h4>✅ Bom:</h4>
                <pre><code>if not usuario:
    return
if not usuario.ativo:
    return
if not usuario.permissao:
    return
if not recurso_disponivel:
    return

processar()</code></pre>
            </div>
        </div>
    </section>

    <section>
        <h2>📊 Exemplo Prático Completo</h2>
        <pre><code>class SistemaLogin:
    def __init__(self):
        self.tentativas_maximas = 3
        self.usuarios = {
            "admin": {"senha": "123456", "ativo": True},
            "user": {"senha": "password", "ativo": False}
        }
    
    def validar_credenciais(self, usuario, senha):
        """Valida credenciais com mensagens específicas"""
        if not usuario or not senha:
            return False, "Usuário e senha são obrigatórios"
        
        if usuario not in self.usuarios:
            return False, "Usuário não encontrado"
        
        dados_usuario = self.usuarios[usuario]
        
        if not dados_usuario["ativo"]:
            return False, "Usuário inativo"
        
        if dados_usuario["senha"] != senha:
            return False, "Senha incorreta"
        
        return True, "Login realizado com sucesso"
    
    def fazer_login(self):
        """Sistema de login com controle de tentativas"""
        tentativas = 0
        
        while tentativas < self.tentativas_maximas:
            usuario = input("Usuário: ")
            senha = input("Senha: ")
            
            sucesso, mensagem = self.validar_credenciais(usuario, senha)
            
            if sucesso:
                print(f"✅ {mensagem}")
                return True
            
            tentativas += 1
            restantes = self.tentativas_maximas - tentativas
            
            print(f"❌ {mensagem}")
            
            if restantes > 0:
                print(f"Tentativas restantes: {restantes}")
            else:
                print("🔒 Acesso bloqueado - muitas tentativas")
                return False
        
        return False</code></pre>
    </section>

    <section>
        <h2>🎮 Exercício Prático</h2>
        <div class="exercise-box">
            <h3>Refatoração de Código</h3>
            <p>Refatore o código abaixo aplicando as boas práticas aprendidas:</p>
            
            <textarea id="code-input" placeholder="# Código para refatorar
def verificar_acesso(u):
    if u != None:
        if u['idade'] >= 18:
            if u['ativo'] == True:
                if u['verificado'] == True:
                    if u['bloqueado'] == False:
                        return True
                    else:
                        return False
                else:
                    return False
            else:
                return False
        else:
            return False
    else:
        return False

# Refatore este código seguindo as boas práticas"></textarea>
            
            <button onclick="runCode()" class="btn-run">▶️ Verificar Refatoração</button>
            <div id="output"></div>
        </div>
    </section>

    <section>
        <h2>📋 Checklist de Boas Práticas</h2>
        <div class="checklist">
            <ul>
                <li>✅ Usar nomes descritivos para variáveis e funções</li>
                <li>✅ Evitar aninhamento excessivo (máximo 3 níveis)</li>
                <li>✅ Preferir early returns</li>
                <li>✅ Extrair condições complexas em funções</li>
                <li>✅ Evitar comparações desnecessárias com True/False</li>
                <li>✅ Usar comentários para lógica complexa</li>
                <li>✅ Validar entrada de dados</li>
                <li>✅ Retornar mensagens de erro específicas</li>
                <li>✅ Manter consistência no estilo do código</li>
                <li>✅ Testar todas as condições possíveis</li>
            </ul>
        </div>
    </section>

    <section>
        <h2>💡 Dicas Finais</h2>
        <div class="tip-box">
            <ul>
                <li>📖 Código é escrito uma vez, mas lido muitas vezes</li>
                <li>🧪 Sempre teste casos extremos e valores inválidos</li>
                <li>🔄 Refatore regularmente para melhorar a qualidade</li>
                <li>👥 Peça feedback de outros programadores</li>
                <li>📚 Continue estudando padrões e práticas da comunidade</li>
            </ul>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
function runCode() {
    const code = document.getElementById('code-input').value;
    const output = document.getElementById('output');
    
    output.innerHTML = '<div class="output-success">Refatoração analisada! Compare seu código com as boas práticas apresentadas.</div>';
}
</script>
{% endblock %}
{% extends "base_aula.html" %}

{% block title %}Aula 10 - Projeto Final Repetitiva | CodeLogic{% endblock %}
{% block lesson_title %}Aula 10 - Projeto Final: Simulador de Jogo{% endblock %}

{% block theory_content %}
<div class="content-section">
    <h2>🎯 Objetivos do Projeto</h2>
    <ul>
        <li>Integrar todos os tipos de loops (for, while, aninhados)</li>
        <li>Aplicar break, continue e else em loops</li>
        <li>Criar um jogo completo com múltiplas funcionalidades</li>
        <li>Implementar menus, validações e controle de fluxo</li>
    </ul>
</div>

<div class="content-section">
    <h2>🎮 Visão Geral do Projeto</h2>
    <p>
        Vamos criar um <strong>Simulador de RPG Textual</strong> com sistema de batalha,
        inventário, níveis e múltiplas opções de jogo.
    </p>
    
    <div class="highlight-box">
        <h3>🎲 Funcionalidades do Jogo:</h3>
        <ul>
            <li>⚔️ Sistema de batalha por turnos</li>
            <li>📦 Gerenciamento de inventário</li>
            <li>📈 Sistema de experiência e níveis</li>
            <li>🛍️ Loja de itens e equipamentos</li>
            <li>🗺️ Exploração de mundos</li>
        </ul>
    </div>
</div>

<div class="content-section">
    <h2>👤 Sistema de Personagem</h2>
    
    <div class="code-example">
        <h3>Classe Personagem:</h3>
        <pre><code>import random

class Personagem:
    def __init__(self, nome):
        self.nome = nome
        self.nivel = 1
        self.vida_max = 100
        self.vida_atual = 100
        self.mana_max = 50
        self.mana_atual = 50
        self.experiencia = 0
        self.exp_proximo_nivel = 100
        self.ouro = 50
        self.ataque = 15
        self.defesa = 5
        self.inventario = []
    
    def subir_nivel(self):
        """Sistema de progressão com loop"""
        while self.experiencia >= self.exp_proximo_nivel:
            self.experiencia -= self.exp_proximo_nivel
            self.nivel += 1
            
            # Aumentar atributos
            self.vida_max += 20
            self.mana_max += 10
            self.ataque += 3
            self.defesa += 2
            
            # Calcular próximo nível
            self.exp_proximo_nivel = int(self.exp_proximo_nivel * 1.5)
            
            print(f"🎉 {self.nome} subiu para o nível {self.nivel}!")
            print(f"   💪 Ataque: {self.ataque} | 🛡️ Defesa: {self.defesa}")
    
    def recuperar_vida(self):
        """Recupera vida com animação"""
        print("💚 Recuperando vida...")
        for i in range(5):
            if self.vida_atual < self.vida_max:
                self.vida_atual = min(self.vida_atual + 10, self.vida_max)
                print(f"   HP: {self.vida_atual}/{self.vida_max}")
            else:
                print("   Vida já está cheia!")
                break</code></pre>
    </div>
</div>

<div class="content-section">
    <h2>⚔️ Sistema de Batalha</h2>
    
    <div class="code-example">
        <h3>Lógica de Combate:</h3>
        <pre><code>def batalhar(jogador, inimigo_nome, inimigo_vida, inimigo_ataque):
    """Sistema de batalha por turnos"""
    print(f"\n⚔️ BATALHA INICIADA: {jogador.nome} vs {inimigo_nome}")
    print("=" * 50)
    
    inimigo_vida_max = inimigo_vida
    turno = 1
    
    while jogador.vida_atual > 0 and inimigo_vida > 0:
        print(f"\n🔄 TURNO {turno}")
        print(f"👤 {jogador.nome}: {jogador.vida_atual}/{jogador.vida_max} HP")
        print(f"👹 {inimigo_nome}: {inimigo_vida}/{inimigo_vida_max} HP")
        
        # Turno do jogador
        while True:  # Loop para validar entrada
            print("\n📝 Escolha sua ação:")
            print("1. ⚔️ Atacar")
            print("2. 🛡️ Defender")
            print("3. 💨 Tentar fugir")
            
            acao = input("Digite sua escolha (1-3): ").strip()
            
            if acao in ['1', '2', '3']:
                break
            else:
                print("❌ Opção inválida! Tente novamente.")
                continue
        
        # Processar ação do jogador
        if acao == '1':  # Atacar
            dano = random.randint(jogador.ataque - 5, jogador.ataque + 5)
            inimigo_vida -= dano
            print(f"⚔️ {jogador.nome} atacou e causou {dano} de dano!")
            
        elif acao == '2':  # Defender
            defesa_extra = random.randint(5, 15)
            jogador.defesa += defesa_extra
            print(f"🛡️ {jogador.nome} se defendeu (+{defesa_extra} defesa neste turno)!")
            
        elif acao == '3':  # Fugir
            chance_fuga = random.randint(1, 100)
            if chance_fuga <= 30:
                print(f"💨 {jogador.nome} conseguiu fugir!")
                return False
            else:
                print(f"💨 {jogador.nome} tentou fugir mas não conseguiu!")
        
        # Verificar se inimigo morreu
        if inimigo_vida <= 0:
            break
        
        # Turno do inimigo
        dano_inimigo = random.randint(inimigo_ataque - 3, inimigo_ataque + 3)
        dano_real = max(1, dano_inimigo - jogador.defesa)
        jogador.vida_atual -= dano_real
        
        print(f"👹 {inimigo_nome} atacou e causou {dano_real} de dano!")
        
        # Resetar defesa extra se usou
        if acao == '2':
            jogador.defesa -= defesa_extra
        
        turno += 1
        
        # Pausa dramática
        input("Pressione Enter para continuar...")
    
    # Resultado da batalha
    if jogador.vida_atual <= 0:
        print(f"\n💀 {jogador.nome} foi derrotado!")
        return False
    else:
        exp_ganha = random.randint(30, 60)
        ouro_ganho = random.randint(10, 25)
        
        print(f"\n🎉 VITÓRIA!")
        print(f"💰 Você ganhou {ouro_ganho} de ouro")
        print(f"⭐ Você ganhou {exp_ganha} de experiência")
        
        jogador.experiencia += exp_ganha
        jogador.ouro += ouro_ganho
        jogador.subir_nivel()
        
        return True</code></pre>
    </div>
</div>

<div class="content-section">
    <h2>🛍️ Sistema de Loja</h2>
    
    <div class="code-example">
        <h3>Loja com Validações:</h3>
        <pre><code>def loja(jogador):
    """Sistema de loja com loops de validação"""
    itens_loja = {
        '1': {'nome': 'Poção de Vida', 'preco': 15, 'efeito': 'vida'},
        '2': {'nome': 'Poção de Mana', 'preco': 12, 'efeito': 'mana'},
        '3': {'nome': 'Espada de Ferro', 'preco': 100, 'efeito': 'ataque'},
        '4': {'nome': 'Armadura de Couro', 'preco': 80, 'efeito': 'defesa'},
        '5': {'nome': 'Anel da Sorte', 'preco': 200, 'efeito': 'especial'}
    }
    
    while True:
        print(f"\n🏪 BEM-VINDO À LOJA!")
        print(f"💰 Seu ouro: {jogador.ouro}")
        print("=" * 40)
        
        # Mostrar itens disponíveis
        for codigo, item in itens_loja.items():
            print(f"{codigo}. {item['nome']} - {item['preco']} ouro")
        
        print("0. 🚪 Sair da loja")
        
        escolha = input("\nO que deseja comprar? ").strip()
        
        if escolha == '0':
            print("👋 Volte sempre!")
            break
        
        if escolha not in itens_loja:
            print("❌ Item não encontrado!")
            continue
        
        item = itens_loja[escolha]
        
        if jogador.ouro < item['preco']:
            print(f"💸 Você não tem ouro suficiente! Precisa de {item['preco']} ouro.")
            continue
        
        # Confirmar compra
        while True:
            confirmacao = input(f"Comprar {item['nome']} por {item['preco']} ouro? (s/n): ").lower()
            
            if confirmacao in ['s', 'sim', 'y', 'yes']:
                jogador.ouro -= item['preco']
                jogador.inventario.append(item['nome'])
                
                # Aplicar efeito
                if item['efeito'] == 'vida':
                    jogador.vida_max += 20
                    jogador.vida_atual += 20
                elif item['efeito'] == 'mana':
                    jogador.mana_max += 15
                    jogador.mana_atual += 15
                elif item['efeito'] == 'ataque':
                    jogador.ataque += 8
                elif item['efeito'] == 'defesa':
                    jogador.defesa += 5
                
                print(f"✅ {item['nome']} comprado com sucesso!")
                break
                
            elif confirmacao in ['n', 'não', 'nao', 'no']:
                print("❌ Compra cancelada.")
                break
            else:
                print("❌ Digite 's' para sim ou 'n' para não.")
                continue</code></pre>
    </div>
</div>

<div class="content-section">
    <h2>🗺️ Sistema de Exploração</h2>
    
    <div class="code-example">
        <h3>Exploração com Eventos Aleatórios:</h3>
        <pre><code>def explorar(jogador):
    """Sistema de exploração com eventos aleatórios"""
    locais = [
        {'nome': 'Floresta Sombria', 'dificuldade': 1},
        {'nome': 'Caverna Misteriosa', 'dificuldade': 2},
        {'nome': 'Montanha Gelada', 'dificuldade': 3},
        {'nome': 'Pântano Venenoso', 'dificuldade': 4},
        {'nome': 'Castelo Assombrado', 'dificuldade': 5}
    ]
    
    print("\n🗺️ ESCOLHA UM LOCAL PARA EXPLORAR:")
    print("=" * 40)
    
    for i, local in enumerate(locais, 1):
        dificuldade_texto = "⭐" * local['dificuldade']
        print(f"{i}. {local['nome']} {dificuldade_texto}")
    
    while True:
        try:
            escolha = int(input("\nEscolha um local (1-5): "))
            if 1 <= escolha <= 5:
                local_escolhido = locais[escolha - 1]
                break
            else:
                print("❌ Escolha um número entre 1 e 5!")
        except ValueError:
            print("❌ Digite um número válido!")
    
    print(f"\n🚶 Explorando {local_escolhido['nome']}...")
    
    # Sistema de eventos durante exploração
    eventos_possiveis = 3 + local_escolhido['dificuldade']
    
    for evento in range(eventos_possiveis):
        print(f"\n📍 Evento {evento + 1}/{eventos_possiveis}")
        
        # Pausa para suspense
        import time
        for i in range(3):
            print(".", end="", flush=True)
            time.sleep(0.5)
        print()
        
        # Evento aleatório
        chance = random.randint(1, 100)
        
        if chance <= 40:  # Encontrar inimigo
            inimigos = [
                ('Goblin', 40, 8),
                ('Orc', 60, 12),
                ('Dragão Bebê', 80, 15),
                ('Esqueleto Guerreiro', 100, 18),
                ('Lich Sombrio', 150, 25)
            ]
            
            inimigo = inimigos[local_escolhido['dificuldade'] - 1]
            nome, vida, ataque = inimigo
            
            print(f"👹 Um {nome} apareceu!")
            
            venceu = batalhar(jogador, nome, vida, ataque)
            if not venceu:
                return  # Sair da exploração se perdeu ou fugiu
                
        elif chance <= 65:  # Encontrar tesouro
            ouro_encontrado = random.randint(5, 20) * local_escolhido['dificuldade']
            print(f"💰 Você encontrou {ouro_encontrado} de ouro!")
            jogador.ouro += ouro_encontrado
            
        elif chance <= 80:  # Evento de cura
            print("🌿 Você encontrou uma fonte mágica!")
            jogador.vida_atual = jogador.vida_max
            jogador.mana_atual = jogador.mana_max
            print("💚 Vida e mana restauradas!")
            
        else:  # Nada acontece
            print("🍃 Você caminha em paz... tudo está calmo.")
        
        if jogador.vida_atual <= 0:
            print(f"\n💀 {jogador.nome} não sobreviveu à exploração...")
            return
    
    print(f"\n🎉 Exploração de {local_escolhido['nome']} concluída!")
    bonus_exp = 20 * local_escolhido['dificuldade']
    print(f"⭐ Bônus de exploração: {bonus_exp} EXP")
    jogador.experiencia += bonus_exp
    jogador.subir_nivel()</code></pre>
    </div>
</div>

<div class="content-section">
    <h2>🎯 Menu Principal</h2>
    
    <div class="code-example">
        <h3>Sistema de Menu Completo:</h3>
        <pre><code>def menu_principal(jogador):
    """Menu principal do jogo com validação"""
    while True:
        print(f"\n🎮 === RPG TEXTUAL ===")
        print(f"👤 Jogador: {jogador.nome} (Nível {jogador.nivel})")
        print(f"❤️ Vida: {jogador.vida_atual}/{jogador.vida_max}")
        print(f"💙 Mana: {jogador.mana_atual}/{jogador.mana_max}")
        print(f"💰 Ouro: {jogador.ouro}")
        print("=" * 30)
        
        opcoes = [
            "🗺️ Explorar",
            "🛍️ Loja",
            "🎒 Inventário",
            "💚 Descansar",
            "📊 Status",
            "🚪 Sair do Jogo"
        ]
        
        for i, opcao in enumerate(opcoes, 1):
            print(f"{i}. {opcao}")
        
        while True:
            try:
                escolha = int(input("\nEscolha uma opção: "))
                if 1 <= escolha <= len(opcoes):
                    break
                else:
                    print(f"❌ Escolha um número entre 1 e {len(opcoes)}!")
            except ValueError:
                print("❌ Digite um número válido!")
        
        # Processar escolha
        if escolha == 1:
            explorar(jogador)
        elif escolha == 2:
            loja(jogador)
        elif escolha == 3:
            mostrar_inventario(jogador)
        elif escolha == 4:
            descansar(jogador)
        elif escolha == 5:
            mostrar_status(jogador)
        elif escolha == 6:
            print("👋 Obrigado por jogar!")
            break
        
        if jogador.vida_atual <= 0:
            print("\n💀 GAME OVER!")
            break

def iniciar_jogo():
    """Função principal para iniciar o jogo"""
    print("🎮 BEM-VINDO AO RPG TEXTUAL!")
    print("=" * 30)
    
    while True:
        nome = input("Digite o nome do seu personagem: ").strip()
        if nome:
            break
        else:
            print("❌ Nome não pode estar vazio!")
    
    jogador = Personagem(nome)
    print(f"\n✨ {nome} foi criado com sucesso!")
    
    menu_principal(jogador)</code></pre>
    </div>
</div>

<div class="content-section">
    <h2>🔧 Conceitos de Loops Aplicados</h2>
    <ul>
        <li><strong>While True:</strong> Menus principais e validações</li>
        <li><strong>For range():</strong> Eventos de exploração e animações</li>
        <li><strong>Break/Continue:</strong> Controle de fluxo em batalhas</li>
        <li><strong>Loops aninhados:</strong> Menus dentro de outros sistemas</li>
        <li><strong>While com condição:</strong> Batalhas e progressão de nível</li>
    </ul>
</div>
{% endblock %}

{% block exercise_content %}
<div class="exercise-header">
    <h2>🏋️‍♂️ Projeto Final</h2>
    <p>Complete o Simulador de RPG Textual</p>
</div>

<div class="exercise-description">
    <h3>📋 Sua Missão:</h3>
    <ol>
        <li>Implemente a função <code>mostrar_inventario()</code></li>
        <li>Complete a função <code>descansar()</code> com animação</li>
        <li>Adicione sistema de magias que gasta mana</li>
        <li>Crie um boss final especial</li>
        <li>Implemente save/load do jogo</li>
        <li>Teste todas as funcionalidades</li>
    </ol>
</div>

<div class="exercise-requirements">
    <h3>🎯 Funcionalidades Obrigatórias:</h3>
    <ul>
        <li><strong>Inventário:</strong> Mostrar itens e permitir usar</li>
        <li><strong>Descanso:</strong> Recuperar vida/mana com animação</li>
        <li><strong>Sistema de Magia:</strong> 3 magias diferentes que gastam mana</li>
        <li><strong>Boss Final:</strong> Inimigo especial com 300 HP</li>
        <li><strong>Validações:</strong> Entrada do usuário sempre validada</li>
    </ul>
</div>

<div class="exercise-bonus">
    <h3>🌟 Funcionalidades Bônus:</h3>
    <ul>
        <li>Sistema de save/load usando arquivos</li>
        <li>Diferentes classes de personagem</li>
        <li>Sistema de crafting de itens</li>
        <li>Mais locais para explorar</li>
    </ul>
</div>

<div class="exercise-hints">
    <h3>💡 Dicas Importantes:</h3>
    <ul>
        <li>Use while True para menus que precisam validação</li>
        <li>For range() é ideal para animações e contadores</li>
        <li>Break e continue controlam o fluxo dos loops</li>
        <li>Try/except para validar entrada numérica</li>
    </ul>
</div>

<div class="expected-output">
    <h3>📤 Resultado Esperado:</h3>
    <pre>🎮 === RPG TEXTUAL ===
👤 Jogador: Herói (Nível 3)
❤️ Vida: 140/140
💙 Mana: 80/80
💰 Ouro: 250

1. 🗺️ Explorar
2. 🛍️ Loja
3. 🎒 Inventário
4. 💚 Descansar
5. 📊 Status
6. 🚪 Sair do Jogo</pre>
</div>
{% endblock %}

{% block starter_code %}
# Projeto Final: Simulador de RPG Textual
# Complete as funções abaixo

import random
import time

class Personagem:
    def __init__(self, nome):
        self.nome = nome
        self.nivel = 1
        self.vida_max = 100
        self.vida_atual = 100
        self.mana_max = 50
        self.mana_atual = 50
        self.experiencia = 0
        self.exp_proximo_nivel = 100
        self.ouro = 50
        self.ataque = 15
        self.defesa = 5
        self.inventario = []

def mostrar_inventario(jogador):
    """
    Mostra inventário e permite usar itens
    Use loops para navegação
    """
    # Seu código aqui
    pass

def descansar(jogador):
    """
    Sistema de descanso com animação
    Use for range() para criar animação
    """
    # Seu código aqui
    pass

def sistema_magia(jogador, inimigo_vida):
    """
    Sistema de magias que gasta mana
    Retorna dano causado ou 0 se não tiver mana
    """
    magias = {
        '1': {'nome': 'Bola de Fogo', 'dano': 25, 'mana': 15},
        '2': {'nome': 'Raio Gélido', 'dano': 20, 'mana': 12},
        '3': {'nome': 'Cura Divina', 'dano': -30, 'mana': 20}  # Dano negativo = cura
    }
    
    # Seu código aqui
    pass

def boss_final(jogador):
    """
    Batalha contra boss final
    Use while para loop de batalha especial
    """
    print("\n🐉 O DRAGÃO ANCIÃO APARECEU!")
    boss_vida = 300
    boss_ataque = 30
    
    # Seu código aqui
    pass

def mostrar_status(jogador):
    """Mostra status detalhado do jogador"""
    print(f"\n📊 STATUS DE {jogador.nome.upper()}")
    print("=" * 40)
    print(f"🏆 Nível: {jogador.nivel}")
    print(f"❤️ Vida: {jogador.vida_atual}/{jogador.vida_max}")
    print(f"💙 Mana: {jogador.mana_atual}/{jogador.mana_max}")
    print(f"⚔️ Ataque: {jogador.ataque}")
    print(f"🛡️ Defesa: {jogador.defesa}")
    print(f"⭐ EXP: {jogador.experiencia}/{jogador.exp_proximo_nivel}")
    print(f"💰 Ouro: {jogador.ouro}")
    print(f"🎒 Itens no inventário: {len(jogador.inventario)}")

# Teste básico do sistema
if __name__ == "__main__":
    print("🎮 TESTE DO SISTEMA RPG")
    jogador_teste = Personagem("Herói")
    
    print("Testando status...")
    mostrar_status(jogador_teste)
    
    # Teste suas funções aqui
    # mostrar_inventario(jogador_teste)
    # descansar(jogador_teste)
{% endblock %}